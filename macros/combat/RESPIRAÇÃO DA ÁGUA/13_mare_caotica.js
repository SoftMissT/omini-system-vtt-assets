(async()=>{const actor=canvas.tokens.controlled[0]?.actor||game.user.character;if(!actor)return ui.notifications.error("âŒ!");const cfg={nome:"VariaÃ§Ã£o: MarÃ© Crescente - CaÃ³tica",jp:"Uchishio - Ran",tipo:"AÃ§Ã£o BÃ´nus",cor:"#048ABF",niveis:[{n:1,d:"2x1d4",acerto:2,c:2},{n:2,d:"2x1d6",acerto:3,c:3},{n:3,d:"2x1d8",acerto:4,c:4},{n:4,d:"2x1d10",acerto:5,c:5}]};const lvl=await new Promise(r=>{new Dialog({title:"í¼Š",content:`<div style="background:#0a0a0f;padding:15px;border:2px solid ${cfg.cor}"><h2 style="color:${cfg.cor}">${cfg.nome}</h2>${cfg.niveis.map(n=>`<p>Nv${n.n}: ${n.d} | +${n.acerto} acerto | ${n.c}PC</p>`).join('')}</div>`,buttons:{n1:{label:"Nv1",callback:()=>r(0)},n2:{label:"Nv2",callback:()=>r(1)},n3:{label:"Nv3",callback:()=>r(2)},n4:{label:"Nv4",callback:()=>r(3)}}}).render(!0)});const sel=cfg.niveis[lvl],pc=actor.system.props?.pc?.value||0;if(pc<sel.c)return ui.notifications.error("âŒ!");const corpo=actor.system.props?.corpo?.value||0,dadoBase=sel.d.split('x')[1],r1=await new Roll(`${dadoBase}+${corpo}`).evaluate(),r2=await new Roll(`${dadoBase}+${corpo}`).evaluate(),total=r1.total+r2.total;game.dice3d&&(await game.dice3d.showForRoll(r1,game.user,!0),await game.dice3d.showForRoll(r2,game.user,!0));await actor.update({"system.props.pc.value":pc-sel.c});const chat=`<div style="background:linear-gradient(135deg,#0a0a0f,#1a1a2e);border:2px solid ${cfg.cor};border-radius:12px;padding:15px"><h2 style="color:${cfg.cor};text-align:center">í¼Š ${cfg.nome}</h2><div style="background:rgba(4,138,191,0.1);padding:10px;text-align:center"><div style="font-size:32px;color:#FFD700;font-weight:bold">${total}</div></div><div style="background:rgba(4,138,191,0.2);padding:8px;margin-top:10px"><strong>âš¡</strong> Vantagem no 1Âº ataque | +${sel.acerto} acerto</div></div>`;await ChatMessage.create({speaker:ChatMessage.getSpeaker({actor}),content:chat});ui.notifications.info(`í¼Š ${total}`)})();
