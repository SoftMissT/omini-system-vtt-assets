{{!-- modules/omini-system-vtt/templates/jjk/character-sheet.hbs --}}
<div class="omni-hud jjk-sheet-container">
    <header class="omni-hud-header">
        <div class="header-left">
            <span class="hud-title">üßø FICHA DE FEITICEIRO JUJUTSU</span>
            <span class="rank-badge">{{jjk.rank}}</span>
        </div>
        <div class="header-right">
            <span class="autosave-indicator">Salvo ‚úî</span>
            <button class="hud-close-btn" data-action="close">‚úï</button>
        </div>
    </header>

    <main class="sheet-body">
        {{!-- Top: Character & Core Stats --}}
        <section class="identity-section">
            <div class="avatar-container">
                <img src="{{actor.img}}" data-edit="img" title="{{actor.name}}">
            </div>
            <div class="identity-info">
                <h2>{{actor.name}}</h2>
                <div class="info-row">
                    <label>T√©cnica:</label>
                    <input type="text" data-field="technique" value="{{jjk.technique}}" placeholder="Nome da T√©cnica...">
                </div>
                <div class="info-row">
                    <label>Dom√≠nio:</label>
                    <input type="text" data-field="domain" value="{{jjk.domain}}" placeholder="Nome do Dom√≠nio...">
                </div>
            </div>
        </section>

        {{!-- Energy Bar --}}
        <section class="energy-section">
            <div class="resource-bar-container">
                <div class="resource-header">
                    <span>‚ö° ENERGIA AMALDI√áOADA</span>
                    <span>{{jjk.energy}} / {{jjk.maxEnergy}}</span>
                </div>
                <div class="progress-bar-track energy">
                    <div class="progress-bar-fill energy" style="width: {{#if jjk.heavenlyRestriction}}0%{{else}}{{math (mult (div jjk.energy jjk.maxEnergy) 100)}}%{{/if}}"></div>
                </div>
            </div>
            <div class="energy-actions">
                <button data-action="syncEnergy" title="Sincronizar com Atributos">
                    <i class="fas fa-sync"></i> Sincronizar
                </button>
            </div>
        </section>

        {{!-- Status Toggles --}}
        <section class="status-toggles">
            <button class="toggle-btn {{#if jjk.rct}}active{{/if}}" data-action="toggleRCT">
                <i class="fas fa-heartbeat"></i> RCT (Shofuku)
            </button>
            <button class="toggle-btn {{#if jjk.heavenlyRestriction}}active{{/if}}" data-action="toggleHeavenly">
                <i class="fas fa-dna"></i> Restri√ß√£o Celestial
            </button>
        </section>

        {{!-- Combat Actions --}}
        <section class="combat-actions">
            <h3>üå©Ô∏è HABILIDADES ESPECIAIS</h3>
            <div class="action-grid">
                <button class="action-btn rct" data-action="toggleRCT" {{#unless jjk.rct}}disabled{{/unless}}>
                    <span class="btn-icon">üíñ</span>
                    <span class="btn-text">Cura Reversa</span>
                </button>
                <button class="action-btn domain" data-action="expandDomain" {{#if jjk.heavenlyRestriction}}disabled{{/if}}>
                    <span class="btn-icon">üåå</span>
                    <span class="btn-text">Expans√£o de Dom√≠nio</span>
                </button>
            </div>
        </section>
        
        {{!-- Rank Selector --}}
        <section class="config-section">
            <div class="info-row">
                <label>Grau de Feiticeiro:</label>
                <select data-field="rank">
                    <option value="Grau 4" {{#if (eq jjk.rank 'Grau 4')}}selected{{/if}}>Grau 4</option>
                    <option value="Grau 3" {{#if (eq jjk.rank 'Grau 3')}}selected{{/if}}>Grau 3</option>
                    <option value="Grau 2" {{#if (eq jjk.rank 'Grau 2')}}selected{{/if}}>Grau 2</option>
                    <option value="Grau 1" {{#if (eq jjk.rank 'Grau 1')}}selected{{/if}}>Grau 1</option>
                    <option value="Especial" {{#if (eq jjk.rank 'Especial')}}selected{{/if}}>Grau Especial</option>
                </select>
            </div>
        </section>
    </main>
</div>
